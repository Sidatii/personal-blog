---
phase: 04-portfolio-features
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - database/migrations/2026_02_07_001000_create_projects_table.php
  - database/migrations/2026_02_07_001100_create_contact_submissions_table.php
  - app/Models/Project.php
  - app/Models/ContactSubmission.php
  - app/Repositories/Contracts/ProjectRepositoryInterface.php
  - app/Repositories/Eloquent/ProjectRepository.php
  - app/Providers/AppServiceProvider.php
autonomous: true

must_haves:
  truths:
    - "Projects table exists with columns for title, slug, description, tech_stack, status, thumbnail, links"
    - "Contact submissions table exists with columns for name, email, subject, message, read status"
    - "Project model has scopes for filtering by status"
    - "ContactSubmission model stores form data"
  artifacts:
    - path: "database/migrations/2026_02_07_001000_create_projects_table.php"
      provides: "Projects table schema"
      contains: "create_projects_table"
    - path: "database/migrations/2026_02_07_001100_create_contact_submissions_table.php"
      provides: "Contact submissions table schema"
      contains: "create_contact_submissions_table"
    - path: "app/Models/Project.php"
      provides: "Project Eloquent model"
      exports: ["Project"]
    - path: "app/Models/ContactSubmission.php"
      provides: "ContactSubmission Eloquent model"
      exports: ["ContactSubmission"]
    - path: "app/Repositories/Contracts/ProjectRepositoryInterface.php"
      provides: "Project repository interface"
      exports: ["ProjectRepositoryInterface"]
    - path: "app/Repositories/Eloquent/ProjectRepository.php"
      provides: "Project repository implementation"
      exports: ["ProjectRepository"]
  key_links:
    - from: "app/Repositories/Eloquent/ProjectRepository.php"
      to: "app/Models/Project.php"
      via: "Eloquent queries"
      pattern: "Project::"
    - from: "app/Providers/AppServiceProvider.php"
      to: "app/Repositories/Contracts/ProjectRepositoryInterface.php"
      via: "service container binding"
      pattern: "ProjectRepositoryInterface.*ProjectRepository"
---

<objective>
Create database schema and models for projects showcase and contact form submissions.

Purpose: Establish the data foundation that the projects showcase (Plan 02) and contact form (Plan 04) depend on. Following the existing repository pattern established in Phase 1 for posts and categories.

Output: Two new database tables (projects, contact_submissions), two Eloquent models, and a project repository with interface binding.
</objective>

<execution_context>
@/home/human/.claude/get-shit-done/workflows/execute-plan.md
@/home/human/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-portfolio-features/04-CONTEXT.md

@app/Models/Post.php
@app/Repositories/Contracts/PostRepositoryInterface.php
@app/Repositories/Eloquent/PostRepository.php
@app/Providers/AppServiceProvider.php
@database/migrations/2026_02_06_003000_create_posts_table.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create projects and contact_submissions migrations and models</name>
  <files>
    database/migrations/2026_02_07_001000_create_projects_table.php
    database/migrations/2026_02_07_001100_create_contact_submissions_table.php
    app/Models/Project.php
    app/Models/ContactSubmission.php
  </files>
  <action>
    Create the projects migration with these columns:
    - id (bigIncrements)
    - title (string, 255)
    - slug (string, 255, unique)
    - short_description (string, 500) - for card display
    - description (text) - full description for detail page
    - tech_stack (json) - array of technology names used in the project
    - status (string, 50) - enum-like: 'active', 'completed', 'archived', 'in-progress'
    - thumbnail (string, nullable) - path to project screenshot/thumbnail
    - live_url (string, nullable) - link to live site
    - github_url (string, nullable) - link to GitHub repo
    - screenshots (json, nullable) - array of screenshot paths for detail page
    - sort_order (integer, default 0) - for manual ordering
    - is_featured (boolean, default false)
    - timestamps
    - softDeletes
    Add indexes on: status, sort_order, is_featured, slug

    Create the contact_submissions migration with these columns:
    - id (bigIncrements)
    - name (string, 255)
    - email (string, 255)
    - subject (string, 255, nullable)
    - message (text)
    - is_read (boolean, default false)
    - ip_address (string, 45, nullable) - for spam tracking
    - user_agent (string, nullable) - for spam tracking
    - timestamps
    Add index on: is_read, created_at

    Create Project model following the Post model pattern:
    - fillable: title, slug, short_description, description, tech_stack, status, thumbnail, live_url, github_url, screenshots, sort_order, is_featured
    - casts: tech_stack as array, screenshots as array, is_featured as boolean
    - SoftDeletes trait
    - scopeActive($query) - where status = 'active'
    - scopeCompleted($query) - where status = 'completed'
    - scopeByStatus($query, $status) - filter by any status value
    - scopeFeatured($query) - where is_featured = true
    - scopeOrdered($query) - orderBy sort_order asc, then created_at desc
    - getRouteKeyName() returns 'slug'

    Create ContactSubmission model:
    - fillable: name, email, subject, message, ip_address, user_agent
    - casts: is_read as boolean
    - scopeUnread($query) - where is_read = false

    Run `php artisan migrate` to apply both migrations.
  </action>
  <verify>
    Run `php artisan migrate` successfully.
    Run `php artisan tinker --execute="echo \App\Models\Project::query()->toRawSql();"` to confirm model loads.
    Run `php artisan tinker --execute="echo \App\Models\ContactSubmission::query()->toRawSql();"` to confirm model loads.
    Check that `php artisan migrate:status` shows both new migrations as ran.
  </verify>
  <done>
    Both tables exist in the database with all specified columns and indexes.
    Both models instantiate without errors and have correct casts and scopes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create ProjectRepository with interface and register binding</name>
  <files>
    app/Repositories/Contracts/ProjectRepositoryInterface.php
    app/Repositories/Eloquent/ProjectRepository.php
    app/Providers/AppServiceProvider.php
  </files>
  <action>
    Create ProjectRepositoryInterface following the PostRepositoryInterface pattern with these methods:
    - all(): Collection - returns all projects ordered
    - findBySlug(string $slug): ?Project
    - getByStatus(string $status): Collection
    - getFeatured(): Collection

    Create ProjectRepository implementing ProjectRepositoryInterface:
    - all(): Project::ordered()->get()
    - findBySlug(string $slug): Project::where('slug', $slug)->first()
    - getByStatus(string $status): Project::byStatus($status)->ordered()->get()
    - getFeatured(): Project::featured()->ordered()->get()

    Register the binding in AppServiceProvider::register():
    - Add `$this->app->bind(ProjectRepositoryInterface::class, ProjectRepository::class);`
    - Follow the existing pattern where PostRepositoryInterface is already bound.
    - Import the new classes at the top of AppServiceProvider.
  </action>
  <verify>
    Run `php artisan tinker --execute="app(\App\Repositories\Contracts\ProjectRepositoryInterface::class);"` to confirm binding resolves.
    Run `php artisan test` to confirm no regressions.
  </verify>
  <done>
    ProjectRepositoryInterface is bound to ProjectRepository in the service container.
    Repository methods return correct query results.
    Existing tests still pass.
  </done>
</task>

</tasks>

<verification>
- `php artisan migrate:status` shows both new migrations as ran
- `php artisan tinker` can instantiate both models
- Service container resolves ProjectRepositoryInterface
- `php artisan test` passes with no regressions
</verification>

<success_criteria>
- projects table exists with all columns (title, slug, short_description, description, tech_stack, status, thumbnail, live_url, github_url, screenshots, sort_order, is_featured)
- contact_submissions table exists with all columns (name, email, subject, message, is_read, ip_address, user_agent)
- Project model has status scopes and JSON casts
- ContactSubmission model has unread scope
- ProjectRepository is bound in service container
</success_criteria>

<output>
After completion, create `.planning/phases/04-portfolio-features/04-01-SUMMARY.md`
</output>

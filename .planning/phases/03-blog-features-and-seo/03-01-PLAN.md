---
phase: 03-blog-features-and-seo
plan: "01"
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - resources/css/app.css
  - resources/js/dark-mode.js
autonomous: true

must_haves:
  truths:
    - "Rose Pine theme colors are available in TailwindCSS"
    - "Dark mode JavaScript initializes theme from cookie with Rose Pine as default"
  artifacts:
    - path: "package.json"
      provides: "@rose-pine/tailwind-css dependency"
    - path: "resources/css/app.css"
      provides: "TailwindCSS with Rose Pine theme imports"
      min_lines: 15
    - path: "resources/js/dark-mode.js"
      provides: "Theme initialization and toggle with cookie persistence"
      min_lines: 25
  key_links:
    - from: "resources/css/app.css"
      to: "@rose-pine/tailwind-css"
      via: "CSS import statement"
      pattern: "@import.*@rose-pine"
    - from: "resources/js/dark-mode.js"
      to: "resources/css/app.css"
      via: "TailwindCSS classes applied based on theme"
      pattern: "document.documentElement.classList"
---

<objective>
Install Rose Pine theme and configure TailwindCSS 4.x with Rose Pine colors. Create dark mode JavaScript with cookie persistence using Rose Pine as default theme.

Purpose: Establish the visual foundation. Rose Pine (main variant) is the default dark theme; Rose Pine Dawn is the light alternative.

Output: TailwindCSS configured with Rose Pine, dark mode script with cookie persistence.
</objective>

<execution_context>
@/home/human/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/human/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-blog-features-and-seo/03-CONTEXT.md
@.planning/phases/03-blog-features-and-seo/03-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install Rose Pine TailwindCSS package</name>
  <files>package.json</files>
  <action>
    Run `npm install @rose-pine/tailwind-css` to install the official Rose Pine color palette for Tailwind 4.x.

    Verify package.json now contains: `"@rose-pine/tailwind-css": "^2.0.0"` (or latest)
  </action>
  <verify>`grep -c '@rose-pine/tailwind-css' package.json` returns >= 1
`npm run build` completes without TailwindCSS errors</verify>
  <done>Rose Pine TailwindCSS package installed. TailwindCSS 4.x can use Rose Pine colors via CSS imports.</done>
</task>

<task type="auto">
  <name>Task 2: Configure TailwindCSS with Rose Pine theme</name>
  <files>resources/css/app.css</files>
  <action>
    Create/update `resources/css/app.css` with TailwindCSS 4.x + Rose Pine configuration:

    1. Import TailwindCSS base
    2. Import Rose Pine (main variant - the default dark theme)
    3. Import Rose Pine Dawn (light theme)
    4. Add custom dark variant: `@custom-variant dark (&:where(.dark, .dark *));`

    ```css
    @import "tailwindcss";

    @custom-variant dark (&:where(.dark, .dark *));

    @import "@rose-pine/tailwind-css/rose-pine.css";
    @import "@rose-pine/tailwind-css/rose-pine-dawn.css";
    ```

    **IMPORTANT:** Use `rose-pine.css` (main variant), NOT `rose-pine-moon.css`. Rose Pine main is the default dark theme per user requirement.
  </action>
  <verify>`grep -c '@custom-variant dark' resources/css/app.css` returns 1
`grep -c 'rose-pine.css' resources/css/app.css` returns >= 1
`grep -c 'rose-pine-dawn.css' resources/css/app.css` returns >= 1
`npm run build` outputs compiled CSS without errors</verify>
  <done>TailwindCSS configured with Rose Pine as default dark theme and Rose Pine Dawn as light. Dark variant configured.</done>
</task>

<task type="auto">
  <name>Task 3: Create dark mode JavaScript with cookie persistence</name>
  <files>resources/js/dark-mode.js</files>
  <action>
    Create `resources/js/dark-mode.js`:

    1. **getCookie(name)** - Helper to read cookie value
    2. **setCookie(name, value, days)** - Helper to set cookie with expiry
    3. **getTheme()** - Check cookie first, default to 'dark' (Rose Pine)
    4. **applyTheme(theme)** - Add/remove 'dark' class on documentElement
    5. **toggleTheme()** - Switch between dark/light, update cookie
    6. **initialize()** - Run on DOMContentLoaded:
       - Get saved theme from cookie OR default to 'dark'
       - Apply theme to documentElement
       - Listen for toggle events

    7. **Cookie persistence:** Use `document.cookie` for cross-device support

    8. **Expose API for components:**
       ```javascript
       window.darkMode = {
           toggle: toggleTheme,
           setTheme: (theme) => {
               setCookie('theme', theme);
               applyTheme(theme);
           },
           getTheme: getTheme
       };
       ```

    9. **Server-side cookie setting endpoint:** Create POST `/api/theme/toggle` that:
       - Accepts JSON body: `{ "theme": "dark" | "light" }`
       - Sets cookie with 30-day expiry
       - Returns current theme

    **Endpoint in routes/api.php:**
    ```php
    Route::post('/theme/toggle', [ThemeController::class, 'toggle'])->name('theme.toggle');
    ```
  </action>
  <verify>`grep -c 'getCookie' resources/js/dark-mode.js` returns >= 1
`grep -c 'setCookie' resources/js/dark-mode.js` returns >= 1
`grep -c "DEFAULT_THEME.*'dark'" resources/js/dark-mode.js` returns 1
`grep -c 'applyTheme' resources/js/dark-mode.js` returns >= 1
`grep -c 'window.darkMode' resources/js/dark-mode.js` returns 1
`grep -c "route.*theme.toggle" routes/api.php` returns 1</verify>
  <done>Dark mode JavaScript with cookie persistence. Rose Pine is default. Exposed via window.darkMode for components. Endpoint ready for toggle.</done>
</task>

</tasks>

<verification>
- Rose Pine colors available via TailwindCSS utility classes
- Dark mode defaults to Rose Pine on first visit
- Cookie persistence works across sessions
- Toggle function available via window.darkMode.toggle()
</verification>

<success_criteria>
- Site renders with Rose Pine colors by default
- Theme persists across page refreshes via cookie
- Toggle function exposed for components
- No external CDN dependencies
</success_criteria>

<output>
After completion, create `.planning/phases/03-blog-features-and-seo/03-01-SUMMARY.md`
</output>

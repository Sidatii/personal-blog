---
phase: 03-blog-features-and-seo
plan: "03"
type: execute
wave: 2
depends_on: ["03-01", "03-02"]
files_modified:
  - composer.json
  - package.json
  - app/Services/ShikiHighlighter.php
autonomous: true

must_haves:
  truths:
    - "Shiki syntax highlighting is installed and configured"
    - "Rose Pine syntax highlighting theme is available"
  artifacts:
    - path: "app/Services/ShikiHighlighter.php"
      provides: "Server-side syntax highlighting with Rose Pine theme"
      min_lines: 25
  key_links:
    - from: "app/Services/ShikiHighlighter.php"
      to: "spatie/shiki-php"
      via: "Shiki::highlight() call"
      pattern: "Shiki::highlight"
---

<objective>
Install spatie/shiki-php for server-side syntax highlighting with Rose Pine theme configuration.

Purpose: Professional code highlighting that works without client-side JavaScript and improves SEO.

Output: Shiki highlighter service configured with Rose Pine syntax theme.
</objective>

<execution_context>
@/home/human/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/human/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-blog-features-and-seo/03-CONTEXT.md
@.planning/phases/03-blog-features-and-seo/03-RESEARCH.md
@.planning/phases/03-blog-features-and-seo/03-01-SUMMARY.md
@.planning/phases/03-blog-features-and-seo/03-02-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install spatie/shiki-php and Shiki</name>
  <files>
    composer.json, package.json
  </files>
  <action>
    Run `composer require spatie/shiki-php` to install Shiki for server-side syntax highlighting.

    Run `npm install shiki` (Shiki needs Node.js runtime for some features).

    Verify composer.json contains: `"spatie/shiki-php": "^3.0"` (or latest)
    Verify package.json contains: `"shiki": "^1.0"` (or latest)
  </action>
  <verify>
`grep -c 'spatie/shiki-php' composer.json` returns >= 1
`grep -c 'shiki' package.json` returns >= 1
`composer dump-autoload` completes without errors
  </verify>
  <done>Shiki PHP library installed for server-side syntax highlighting with VSCode-quality themes.</done>
</task>

<task type="auto">
  <name>Task 2: Create ShikiHighlighter service</name>
  <files>
    app/Services/ShikiHighlighter.php
  </files>
  <action>
    Create `app/Services/ShikiHighlighter.php`:

    1. Constructor initializes Shiki with Rose Pine theme:
       ```php
       use Spatie\ShikiPhp\Shiki;

       private Shiki $shiki;

       public function __construct()
       {
           $this->shiki = Shiki::create([
               'theme' => 'rose-pine',
           ]);
       }
       ```

    2. highlight() method:
       ```php
       public function highlight(string $code, string $language = 'php'): string
       {
           return $this->shiki->highlight($code, $language);
       }
       ```

    3. Available for dependency injection throughout the application.

    **Note:** Use `rose-pine` theme (main variant), NOT `rose-pine-moon`.
  </action>
  <verify>
`grep -c 'rose-pine' app/Services/ShikiHighlighter.php` returns >= 1
`grep -c 'Spatie\\\ShikiPhp' app/Services/ShikiHighlighter.php` returns >= 1
  </verify>
  <done>ShikiHighlighter service configured with Rose Pine theme for consistent code highlighting.</done>
</task>

</tasks>

<verification>
- Shiki syntax highlighting installed
- Rose Pine theme available for highlighting
- ShikiHighlighter service ready for dependency injection
</verification>

<success_criteria>
- Composer shows spatie/shiki-php installed
- ShikiHighlighter can be resolved from container
- highlight() method returns HTML with Rose Pine colors
</success_criteria>

<output>
After completion, create `.planning/phases/03-blog-features-and-seo/03-03-SUMMARY.md`
</output>

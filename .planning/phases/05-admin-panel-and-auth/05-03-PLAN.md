---
phase: 05-admin-panel-and-auth
plan: 03
type: execute
wave: 2
depends_on: ["05-02"]
files_modified:
  - app/Http/Controllers/Admin/PostController.php
  - app/Http/Controllers/Admin/CategoryController.php
  - app/Http/Controllers/Admin/TagController.php
  - resources/views/admin/posts/index.blade.php
  - resources/views/admin/posts/create.blade.php
  - resources/views/admin/posts/edit.blade.php
  - resources/views/admin/categories/index.blade.php
  - resources/views/admin/categories/form.blade.php
  - resources/views/admin/tags/index.blade.php
  - resources/views/admin/tags/form.blade.php
  - routes/admin.php
autonomous: true

must_haves:
  truths:
    - "Admin can list, create, edit, and delete posts"
    - "Admin can manage categories (CRUD)"
    - "Admin can manage tags (CRUD)"
    - "Forms include validation and error handling"
    - "Success messages shown after operations"
  artifacts:
    - path: "app/Http/Controllers/Admin/PostController.php"
      provides: "Post CRUD operations"
      exports: ["index", "create", "store", "edit", "update", "destroy"]
    - path: "resources/views/admin/posts/index.blade.php"
      provides: "Posts list with actions"
      contains: "table, pagination, action buttons"
    - path: "app/Http/Controllers/Admin/CategoryController.php"
      provides: "Category CRUD operations"
      exports: ["index", "create", "store", "edit", "update", "destroy"]
  key_links:
    - from: "routes/admin.php"
      to: "app/Http/Controllers/Admin/PostController.php"
      via: "Route::resource"
      pattern: "Route::resource.*posts"
---

<objective>
Implement full CRUD operations for posts, categories, and tags in the admin panel.

Purpose: Allow admin to manage all blog content including creating new posts, editing existing ones, organizing with categories and tags.

Output: Controllers and views for posts, categories, and tags CRUD operations.
</objective>

<execution_context>
@/home/human/.config/opencode/get-shit-done/workflows/execute-plan.md
@/home/human/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/05-admin-panel-and-auth/05-02-SUMMARY.md

@app/Models/Post.php
@app/Models/Category.php
@app/Models/Tag.php
@routes/admin.php
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create Post CRUD controller and views</name>
  <files>
    app/Http/Controllers/Admin/PostController.php
    resources/views/admin/posts/index.blade.php
    resources/views/admin/posts/create.blade.php
    resources/views/admin/posts/edit.blade.php
  </files>
  <action>
    Create PostController with resource methods:
    - index(): Paginated posts list (15 per page), with search/filter support
    - create(): Show form with categories and tags
    - store(StorePostRequest $request): Create post, sync tags, redirect with success
    - edit(Post $post): Show edit form with current data
    - update(UpdatePostRequest $request, Post $post): Update post, sync tags
    - destroy(Post $post): Delete post, redirect with success

    Create Form Requests:
    - StorePostRequest: title (required, max:255), slug (required, unique), excerpt (nullable), content (required), category_id (nullable), tags (nullable, array), published_at (nullable, date)
    - UpdatePostRequest: Same as store but unique rules ignore current post

    Create views:
    - index.blade.php: Table with columns (ID, title, category, status, date, actions), pagination, search input
    - create.blade.php: Form with all fields, category select, tags multi-select, date picker
    - edit.blade.php: Similar to create but with current values, show created/updated dates

    Note: Content is markdown - use textarea, not WYSIWYG
  </action>
  <verify>
    Controller loads: `php -l app/Http/Controllers/Admin/PostController.php`
    Routes work: `php artisan route:list --path=admin/posts`
    CRUD operations work via browser
  </verify>
  <done>
    Full Post CRUD functional: list, create, edit, delete with validation
  </done>
</task>

<task type="auto">
  <name>Task 2: Create Category CRUD controller and views</name>
  <files>
    app/Http/Controllers/Admin/CategoryController.php
    resources/views/admin/categories/index.blade.php
    resources/views/admin/categories/form.blade.php
  </files>
  <action>
    Create CategoryController:
    - index(): All categories with post counts
    - create(): Show form
    - store(): Create category
    - edit(): Show edit form
    - update(): Update category
    - destroy(): Delete if no posts, otherwise show error

    Create form request:
    - CategoryRequest: name (required, max:255), slug (required, unique), description (nullable)

    Create views:
    - index.blade.php: Table with name, slug, post count, actions
    - form.blade.php: Shared form for create/edit with name, slug, description fields

    Add route: Route::resource('categories', CategoryController::class)
  </action>
  <verify>
    Routes: `php artisan route:list --path=admin/categories`
    Can create, edit, delete categories
  </verify>
  <done>
    Category CRUD complete with post count display
  </done>
</task>

<task type="auto">
  <name>Task 3: Create Tag CRUD controller and views</name>
  <files>
    app/Http/Controllers/Admin/TagController.php
    resources/views/admin/tags/index.blade.php
    resources/views/admin/tags/form.blade.php
  </files>
  <action>
    Create TagController similar to CategoryController:
    - Same CRUD pattern
    - Validation: name (required, max:255), slug (required, unique)
    - Views similar to categories but simpler (no description)
    - Show post count for each tag

    Add route: Route::resource('tags', TagController::class)
  </action>
  <verify>
    Routes: `php artisan route:list --path=admin/tags`
    Tag CRUD works end-to-end
  </verify>
  <done>
    Tag CRUD complete
  </done>
</task>

</tasks>

<verification>
- /admin/posts shows paginated post list
- Can create new post with all fields
- Can edit existing post
- Can delete post with confirmation
- /admin/categories shows categories with post counts
- Category CRUD works
- /admin/tags shows tags with post counts
- Tag CRUD works
- All forms have validation
- Success messages shown after operations
</verification>

<success_criteria>
- Full CRUD for posts with pagination and search
- Full CRUD for categories with post counts
- Full CRUD for tags with post counts
- Form validation on all operations
- Success/error messages displayed
- All routes protected by admin middleware
</success_criteria>

<output>
After completion, create `.planning/phases/05-admin-panel-and-auth/05-03-SUMMARY.md`
</output>
